function [f,g,h] = CEC2021_func(x,func)
% CEC2021_func Real world Multi-objective Constrained Optimization Test Suite 
% Abhishek Kumar (email: abhishek.kumar.eee13@iitbhu.ac.in, Indian Institute of Technology (BHU), Varanasi) 

% x -----> ps X D where 'ps': number of population and 'D': Dimension of
% the problem.
% f -----> Objective Function Value.
% g -----> Inequality Consstraints Value; ps X ng where 'ng': number of
% inequality constraints.
% h -----> Equality Constraints Value; ps X nh where 'nh': number of
% equality constraints.
% prob_k -> Index of problem.

[ps,D] = size(x);

%% Meachnical problems

if func == 1
    %% Pressure Vessal Problems
    x1 = round(x(:,1));
    x2 = round(x(:,2));
    x3 = x(:,3);
    x4 = x(:,4);
    z1 = 0.0625*x1;
    z2 = 0.0625*x2;
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 1.7781.*z1.*x3.^2+0.6224.*z1.*x2.*x4+3.1661.*z1.^2.*x4+19.84.*z1.^2.*x3;
    f(:,2) = -pi.*x3.^2.*x4-(4/3).*pi.*x3.^3;
    %% constraints
    g = zeros(ps,2);
    h = zeros(ps,0);
    g(:,1) = 0.00954.*x3-z2;
    g(:,2) = 0.0193.*x3-z1;
elseif func == 2
    %% Vibrating Platform
    d1 = x(:,1);
    d2 = x(:,2);
    d3 = x(:,3);
    b = x(:,4);
    L = x(:,5);
    rho1 = 100; rho2 = 2770; rho3 = 7780;
    E1 = 1.6; E2 = 70; E3 = 200;
    c1 = 500; c2 = 1500; c3 = 800;
    mu = 2*b.*(rho1.*d1+rho2.*(d2-d1)+rho3.*(d3-d2));
    EI = (2*b./3).*(E1.*d1.^3+E2.*(d2.^3-d1.^3)+rho3.*(d3-d2));
    %% objective function
    f = zeros(ps,2);
    f(:,1) = (-pi)./(2*L).^2.*(abs(EI./mu)).^0.5;
    f(:,2) = 2*b.*L.*(c1.*d1+c2.*(d2-d1)+c3.*(d3-d2));
    %% constraints
    g = zeros(ps,5);
    h = zeros(ps,0);
    g(:,1) = mu.*L -2800;
    g(:,2) = d1-d2;
    g(:,3) = d2-d1-0.15;
    g(:,4) = d2-d3;
    g(:,5) = d3-d2-0.01;
elseif func == 3
    %% Two bar Truss design Problems
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = x1.*(16+x3.^2).^(0.5)+x2.*(1+x3.^2).^(0.5);
    f(:,2) = (20.*(16+x3.^2).^(0.5))./(x3.*x1);
    %% constraints
    g = zeros(ps,3);
    h = zeros(ps,0);
    g(:,1) = f(:,1)-0.1;
    g(:,2) = f(:,2)-1e5;
    g(:,3) = (80.*(1+x3.^2).^(0.5))./(x3.*x2)-1e5;
elseif func == 4
    %% Weldan Beam Design Problem
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    x4 = x(:,4);
    P = 6000;
    L = 14;
    E = 30e6;
    tmax = 13600;
    sigmax = 30000;
    G = 12e6;
    Pc = (4.013.*E.*((x3.^2+x4.^6)./36).^0.5)./(L.^2).*(1-x3./(2.*L).*(E./(4*G))^(0.5));
    sigma = (6.*P.*L)./(x4.*x3.^2);
    J = 2.*(sqrt(2).*x1.*x2.*(x2.^2/12+((x1+x3)./2).^2));
    R = sqrt(x2.^2/4+((x1+x3)./2).^2);
    M = P.*(L+x2./2);
    tho1 = P./(sqrt(2).*x1.*x2);
    tho2 = M.*R./J;
    tho = sqrt(tho1.^2+2.*tho1.*tho2.*x2./(2*R)+tho2.^2);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 1.10471.*x1.^2.*x2+0.04811.*x3.*x4.*(14+x2);
    f(:,2) = (4.*P.*L.^3)./(E.*x4.*x3.^3);
    %% constraints
    g = zeros(ps,4);
    h = zeros(ps,0);
    g(:,1) = tho -tmax;
    g(:,2) = sigma - sigmax;
    g(:,3) = x1-x4;
    g(:,4) = P - Pc;
elseif func == 5
    %% Disc Brake Design Problem
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    x4 = x(:,4);
    %% objective function 
    f = zeros(ps,2);
    f(:,1) = 4.9e-5.*(x2.^2-x1.^2).*(x4-1);
    f(:,2) = 9.82e6.*(x2.^2-x1.^2)./(x3.*x4.*(x2.^3-x1.^3));
    %% constraints
    g = zeros(ps,4);
    h = zeros(ps,0);
    g(:,1) = 20 - (x2 - x1);
    g(:,2) = x3./(3.14.*(x2.^2-x1.^2)) - 0.4;
    g(:,3) = 2.22e-3.*x3.*(x2.^3-x1.^3)./(x2.^2-x1.^2).^2-1;
    g(:,4) = 900 - 2.66e-2.*x3.*x4.*(x2.^3-x1.^3)./(x2.^2-x1.^2);
elseif func == 6
    %% Speed Reducer Design Problem
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = round(x(:,3));
    x4 = x(:,4);
    x5 = x(:,5);
    x6 = x(:,6);
    x7 = x(:,7);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 0.7854.*x1.*x2.^2.*(10.*x3.^2/3+14.933.*x3-43.0934) - 1.508.*x1.*(x6.^2+x7.^2)+7.477.*(x6.^3+x7.^3)+0.7854.*(x4.*x6.^2+x5.*x7.^2);
    f(:,2) = sqrt((745.*x4./(x2.*x3)).^2+1.69e7)./(0.1.*x6.^3);
    %% constraints
    g = zeros(ps,11);
    h = zeros(ps,0);
    g(:,1) = 1./(x1.*x2.^2.*x3)-1/27;
    g(:,2) = 1./(x1.*x2.^2.*x3.^2)-1/397.5;
    g(:,3) = x4.^3./(x2.*x3.*x6.^4)-1/1.93;
    g(:,4) = x5.^3./(x2.*x3.*x7.^4)-1/1.93;
    g(:,5) = x2.*x3-40;
    g(:,6) = x1./x2-12;
    g(:,7) = -x1./x2+5;
    g(:,8) = 1.9-x4+1.5.*x6;
    g(:,9) = 1.9-x5+1.1.*x7;
    g(:,10) = f(:,2)-1300;
    g(:,11) = sqrt((745.*x5./(x2.*x3)).^2+1.575e8)./(0.1*x7.^3)-850;
elseif func == 7
    %% Gear Train Design Problems
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    x4 = x(:,4);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = abs(6.931-x3.*x4./(x1.*x2));
    f(:,2) = max(x,[],2);
    %% constraints
    g = zeros(ps,1);
    h = zeros(ps,0);
    g(:,1) = f(:,1)./6.931-0.5;
elseif func == 8
    %% Car Side Impact Desifn Problem
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    x4 = x(:,4);
    x5 = x(:,5);
    x6 = x(:,6);
    x7 = x(:,7);
    VMBP = 10.58-0.674.*x1.*x2-0.67275.*x2;
    VFD  = 16.45-0.489.*x3.*x7-0.843.*x5.*x6;
    %% objective function
    f = zeros(ps,3);
    f(:,1) = 1.98+4.9.*x1.*6.67.*x2+6.98.*x3+4.01.*x4+1.78.*x5+1e-5.*x6+2.73.*x7;
    f(:,2) = 4.72-0.5.*x4-0.19.*x2.*x3;
    f(:,3) = 0.5.*(VMBP+VFD);
    %% constraints
    g = zeros(ps,9);
    h = zeros(ps,0);
    g(:,1) = -1+1.16-0.3717.*x2.*x4-0.0092928.*x3;
    g(:,2) = -0.32+0.261-0.0159.*x1.*x2-0.06486.*x1-0.019.*x2.*x7+0.0144.*x2.*x5+0.0154464.*x6;
    g(:,3) = -0.32+0.74-0.61.*x2-0.031296.*x3-0.031872.*x7+0.227.*x2.^2;
    g(:,4) = -0.32+0.214+0.00817.*x5-0.045195.*x1-0.0135168.*x1+0.03099.*x2.*x6-0.018.*x2.*x7+0.007176.*x3+0.023232.*x3-0.00364.*x5.*x6-0.018.*x2.^2;
    g(:,5) = -32+33.86+2.95.*x3-5.057.*x1.*x2-3.795.*x2-3.4431.*x7+1.45728;
    g(:,6) = -32+28.98+3.818.*x3-4.2.*x1.*x2+1.27296.*x6-2.68065.*x7;
    g(:,7) = -32+46.36-9.9.*x2-4.4505.*x1;
    g(:,8) = f(:,2)-4;
    g(:,9) = VMBP - 9.9;
elseif func == 9
    %% Four Bar Plane Truss
    F = 10; E = 2e5; L = 200; sig = 10;
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = x(:,3);
    x4 = x(:,4);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = L.*(2*x1+sqrt(2).*x2+sqrt(2).*x3+x4);
    f(:,2) = F.*L./E.*(2./x1+2.*sqrt(2)./x2-2.*sqrt(2)./x3+2./x4);
    %% constraints
    g = zeros(ps,0);
    h = zeros(ps,0);
elseif func == 10
    %% Two bar plane Truss
    x1 = x(:,1);
    x2 = x(:,2);
    rho = 0.283;
    h = 100;
    P = 104;
    E = 3e7;
    rho0 = 2e4;
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 2.*rho.*h.*x2.*sqrt(1+x1.^2);
    f(:,2) = rho.*h.*(1+x1.^2).^1.5.*(1+x1.^4).^0.5./(2.*sqrt(2).*E.*x1.^2.*x2);
    %% constraints
    g = zeros(ps,2);
    h = zeros(ps,2);
    g(:,1) = P.*(1+x1).*(1+x1.^2).^0.5./(2.*sqrt(2).*x1.*x2)-rho0;
    g(:,2) = P.*(-x1+1).*(1+x1.^2).^0.5./(2.*sqrt(2).*x1.*x2)-rho0;
elseif func == 11
    %% Water Resource Management Problem
     x1 = x(:,1);
	 x2 = x(:,2);
	 x3 = x(:,3);
	 %% objectives
     f = zeros(ps,5);
	 f(:,1) = 106780.37 .* (x2 + x3) + 61704.67 ;
	 f(:,2) = 3000 .* x1 ;
	 f(:,3) = 305700 .* 2289 .* x2 ./ power(0.06.*2289, 0.65) ;
	 f(:,4) = 250 .* 2289 .* exp(-39.75.*x2+9.9.*x3+2.74) ;
	 f(:,5) = 25 .* (1.39 ./(x1.*x2) + 4940.*x3 -80) ;
	%% Constraints   
    g = zeros(ps,7);
    h = zeros(ps,0);
	g(:,1) = 1 - (0.00139./(x1.*x2)+4.94.*x3-0.08);
	g(:,2) = 1 - (0.000306./(x1.*x2)+1.082.*x3-0.0986);
	g(:,3) = 50000 - (12.307./(x1.*x2) + 49408.24.*x3+4051.02);
	g(:,4) = 16000 - (2.098./(x1.*x2)+8046.33.*x3-696.71);
	g(:,5) = 10000 - (2.138./(x1.*x2)+7883.39.*x3-705.04);
	g(:,6) = 2000 - (0.417.*x1.*x2 + 1721.26.*x3-136.54);
	g(:,7) = 550 - (0.164./(x1.*x2)+631.13.*x3-54.48);
    g = -g;
elseif func == 12
    %% Simply supported I-beam design  
     x1 = x(:,1);
	 x2 = x(:,2);
	 x3 = x(:,3);
	 x4 = x(:,4);
     P = 600;
     L = 200;
     E = 2e4;
	%% objectives
    f = zeros(ps,2);
	f(:,1) = 2 .* x2 .* x4 + x3 .* (x1- 2.*x4);
	f(:,2) = P.*L.^3./(48.*E.*(x3 .*((x1 - 2.*x4).^3)+2.*x2.*x4.*(4.*x4.*x4+3.*x1.*(x1-2.*x4)))./12);
	%% constraints
    g = zeros(ps,1);
    h = zeros(ps,0);
	g(:,1) = -16 + 180000*x1./(x3.*((x1 - 2*x4).^3)+2*x2.*x4.*(4.*x4.*x4+3*x1.*(x1-2*x4)))...
             + 15000.*x2./((x1-2.*x4).*x3.^3+2.*x4.*x2.^3);
elseif func == 13
    %% Gear box design 
    x1 = x(:,1);
    x2 = x(:,2);
    x3 = round(x(:,3));
    x4 = x(:,4);
    x5 = x(:,5);
    x6 = x(:,6);
    x7 = x(:,7);
    %% objective function
    f = zeros(ps,3);
    f(:,1) = 0.7854.*x1.*x2.^2.*(10.*x3.^2/3+14.933.*x3-43.0934) - 1.508.*x1.*(x6.^2+x7.^2)+7.477.*(x6.^3+x7.^3)+0.7854.*(x4.*x6.^2+x5.*x7.^2);
    f(:,2) = sqrt((745.*x4./(x2.*x3)).^2+1.69e7)./(0.1.*x6.^3);
    f(:,3) = sqrt((745.*x5./(x2.*x3)).^2+1.575e8)./(0.1*x7.^3);
    %% constraints
    g = zeros(ps,11);
    h = zeros(ps,0);
    g(:,1) = 1./(x1.*x2.^2.*x3)-1/27;
    g(:,2) = 1./(x1.*x2.^2.*x3.^2)-1/397.5;
    g(:,3) = x4.^3./(x2.*x3.*x6.^4)-1/1.93;
    g(:,4) = x5.^3./(x2.*x3.*x7.^4)-1/1.93;
    g(:,5) = x2.*x3-40;
    g(:,6) = x1./x2-12;
    g(:,7) = -x1./x2+5;
    g(:,8) = 1.9-x4+1.5.*x6;
    g(:,9) = 1.9-x5+1.1.*x7;
    g(:,10) = f(:,2)-1300;
    g(:,11) = f(:,3)-1100;
elseif func == 14
    %% Multiple-disk clutch brake design problem 
   Mf = 3; Ms = 40; Iz = 55; n = 250; Tmax = 15; s = 1.5; delta = 0.5; 
   Vsrmax = 10; rho = 0.0000078; pmax = 1; mu = 0.6; Lmax = 30; delR = 20;
   Rsr = 2./3.*(x(:,2).^3-x(:,1).^3)./(x(:,2).^2.*x(:,1).^2);
   Vsr = pi.*Rsr.*n./30;
   A   = pi.*(x(:,2).^2-x(:,1).^2);
   Prz = x(:,4)./A;
   w   = pi.*n./30;
   Mh  = 2/3.*mu.*x(:,4).*x(:,5).*(x(:,2).^3-x(:,1).^3)./(x(:,2).^2-x(:,1).^2);
   T   = Iz.*w./(Mh+Mf);
   %% objective function
   f = zeros(ps,2);
   f(:,1) = pi.*(x(:,2).^2-x(:,1).^2).*x(:,3).*(x(:,5)+1).*rho;
   f(:,2) = T;
   %% constraints
   g(:,1) = -x(:,2)+x(:,1)+delR;
   g(:,2) = (x(:,5)+1).*(x(:,3)+delta)-Lmax;
   g(:,3) = Prz-pmax;
   g(:,4) = Prz.*Vsr-pmax.*Vsrmax;
   g(:,5) = Vsr-Vsrmax;
   g(:,6) = T-Tmax;
   g(:,7) = s.*Ms-Mh;
   g(:,8) = -T;
   h      = zeros(ps,0);
elseif func == 15
    %% Spring design Problem  
    x1 = round(x(:,1));
        x2 = x(:,2);
        d  = [0.009,0.0095,0.0104,0.0118,0.0128,0.0132,0.014,....
              0.015, 0.0162, 0.0173, 0.018, 0.020, 0.023, 0.025,...
              0.028, 0.032, 0.035, 0.041, 0.047, 0.054, 0.063,....
              0.072, 0.080, 0.092, 0.0105, 0.120, 0.135, 0.148,....
              0.162, 0.177, 0.192, 0.207, 0.225, 0.244, 0.263,....
              0.283, 0.307, 0.331, 0.362,0.394,0.4375,0.500];
        x3 = d(max(1,min(42,round(x(:,3))))); x3 = x3(:);
        %% constants
        cf = (4.*x2./x3-1)./(4.*x2./x3-4)+0.615.*x3./x2;
        K  = (11.5.*10.^6.*x3.^4)./(8.*x1.*x2.^3);
        lf = 1000./K + 1.05.*(x1+2).*x3;
        sigp = 300./K;
        %% objective function
        f = zeros(ps,2);
        f(:,1) = (pi.^2.*x2.*x3.^2.*(x1+2))./4;
        f(:,2) = (8000.*cf.*x2)./(pi.*x3.^3);
        %% constraints
        g(:,1) = (8000.*cf.*x2)./(pi.*x3.^3)-189000;
        g(:,2) = lf-14;
        g(:,3) = 0.2-x3;
        g(:,4) = x2-3;
        g(:,5) = 3-x2./x3;
        g(:,6) = sigp - 6;
        g(:,7) = sigp+700./K+1.05.*(x1+2).*x3-lf;
        g(:,8) = 1.25-700./K;
        h = zeros(ps,0);

elseif func == 16
    %% Cantilever beam design problem 
    x1 = x(:,1);
    x2 = x(:,2);
    
    P = 1;
    E = 207000000;
    Sy = 300000;
    delta_max = 0.005;
    rho = 7800;
    
    %% objectives
    f = zeros(ps,2);
    f(:,1) = 0.25 .* rho .* pi .* x2 .* x1.^2;
    f(:,2) = (64 .* P .* x2.^3)./(3 .* E .* pi .* x1.^4);
    
    %% constraints
    g = zeros(ps,2);
    h = zeros(ps,0);
    g(:,1) = -Sy + (32 .* P .* x2)./(pi .* x1.^3);
    g(:,2) = -delta_max + (64 .* P .* x2.^3)./(3 .* E .* pi .* x1.^4);
    
elseif func == 17
    %% Bulk carriers design problem 
    L = x(:,1);
	B = x(:,2);
	D = x(:,3);
	T = x(:,4);
	V_k = x(:,5);
	C_B = x(:,6);
    
	a = 4977.06.*C_B.^2 - 8105.61.*C_B + 4456.51;
    b = -10847.2.*C_B.^2 + 12817.*C_B - 6960.32;
    F_n = 0.5144./(9.8065 .* L).^0.5;
    P = ((1.025.*L.*B.*T.*C_B).^(2/3).*V_k.^3)./(a + b.*F_n);
    
    W_s = 0.034.*L.^1.7.*B.^0.6.*D.^0.4.*C_B.^0.5;
	W_o = L.^0.8.*B.^0.6.*D.^0.3.*C_B.^0.1;
	W_m = 0.17.*P.^0.9;
    ls = W_s+W_o+W_m;
    
	D_wt = 1.025.*L.*B.*T.*C_B-ls;
	F_c = 0.19.*24.*P./1000 + 0.2;
	D_cwt = D_wt - F_c.*((5000.*V_k)./24 + 5)-2.*D_wt.^0.5;
	R_trp = 350./((5000.*V_k)./24 + 2.*(D_cwt./8000 + 0.5));
    ac = D_cwt.*R_trp;
	S_d = 5000.*V_k./24;
    
    C_c = 0.2.*1.3 .* (2000.*W_s.^0.85 + 3500.*W_o + 2400.*P.^0.8);
	C_r = 40000.*D_wt.^0.3;
	C_v = (1.05.*100.*F_c.*S_d + 6.3.*D_wt.^0.8).*R_trp;

    %% objectives
    f = zeros(ps,3);
	f(:,1)= (C_c + C_r + C_v)./ac;
	f(:,2) = ls;
	f(:,3) = -ac;
    %% constraints
    g = zeros(ps,9);
    h = zeros(ps,0);
	g(:,1) = L./B - 6;
	g(:,2)= 15 - L./D;
	g(:,3) = 19 - L./T;
	g(:,4) = 0.45.*D_wt.^0.31 - T;
	g(:,5) = 0.7.*D + 0.7 - T;
	g(:,6) = 0.32 - F_n;
	g(:,7) = 0.53.*T + ((0.085.*C_B - 0.002).*B.^2)./(T.*C_B)-(1 + 0.52.*D) - 0.07.*B;
    g(:,8) = D_wt - 3000;
    g(:,9) = 500000 - D_wt;
    g = -g;
elseif func == 18
    %% Front rail design problem 
    hh = x(:,1);
    w = x(:,2);
    t = x(:,3);
    
    Ea = 14496.5;
    Fa = 234.9;
    E = -70973.4 + 958.656 .* w+ 614.173 .* hh - 3.827 .* w .* hh + 57.023 .* w .* t + 63.274 .* hh .* t-3.582 .* w.^2 - 1.4842 .* hh.^2 - 1890.174 .* t.^2;
    F = 111.854 - 20.210 .* w + 7.560 .* hh - 0.025 .* w .* hh + 2.731 .* w .* t - 1.479 .* hh .* t + 0.165 .* w.^2;
        
    %% objectives
    f = zeros(ps,2);
    f(:,1) = Ea./E;
    f(:,2) = F./Fa;
    
    %% constraints
    g = zeros(ps,3);
    h = zeros(ps,0);
    g(:,1) = (hh - 136).* (146 - hh);
    g(:,2) = (w - 58) .* (66 - w);
    g(:,3) = (t - 1.4) .* (2.2 - t);
    g = -g;
elseif func == 19
    %% Multi-product batch plant
    %% constant
   S = [2,3,4;
        4,6,3];
   t = [8,20,8;
        16,4,4];
   H = 6000; alp = 250; beta = 0.6;
   Q1 = 40000; Q2 = 20000;
   %% decision Variable
   N1 = round(x(:,1)); N2 = round(x(:,2)); N3 = round(x(:,3));
   V1 = x(:,4); V2 = x(:,5); V3 = x(:,6);
   TL1 = x(:,7); TL2 = x(:,8);
   B1 = x(:,9); B2 = x(:,10);
   %% objective function
   f = zeros(ps,3);
   f(:,1) = alp.*(N1.*V1.^beta+N2.*V2.^beta+N3.*V3.^beta);
   f(:,2) = 65.*(Q1./B1+Q2./B2)+0.08.*Q1+0.1.*Q2;
   f(:,3) = Q1.*TL1./B1+Q2.*TL2./B2;
   %% constraints
   g(:,1) = Q1.*TL1./B1+Q2.*TL2./B2-H;
   g(:,2) = S(1,1).*B1+S(2,1).*B2-V1;
   g(:,3) = S(1,2).*B1+S(2,2).*B2-V2;
   g(:,4) = S(1,3).*B1+S(2,3).*B2-V3;
   g(:,5) = t(1,1)-N1.*TL1;
   g(:,6) = t(1,2)-N2.*TL1;
   g(:,7) = t(1,3)-N3.*TL1;
   g(:,8) = t(2,1)-N1.*TL2;
   g(:,9) = t(2,2)-N2.*TL2;
   g(:,10) = t(2,3)-N3.*TL2;
   h = zeros(ps,0);
elseif func == 20
    %% Hydro-static thrust bearing design problem
    R = x(:,1); Ro = x(:,2);  mu = x(:,3); Q = x(:,4);
    gamma = 0.0307; C = 0.5; n = -3.55; C1 = 10.04;
    Ws = 101000; Pmax = 1000; delTmax = 50; hmin = 0.001;
    gg = 386.4; N = 750;
    P    = (log10(log10(8.122*1e6.*mu+0.8))-C1)./n;
    delT = 2.*(10.^P-560);
    Ef   = 9336.*Q.*gamma.*C.*delT;
    h    = (2.*pi.*N./60).^2.*2.*pi.*mu./Ef.*(R.^4./4-Ro.^4./4)-1e-5;
    Po   = (6.*mu.*Q./(pi.*h.^3)).*log(R./Ro);
    W    = pi.*Po./2.*(R.^2-Ro.^2)./(log(R./Ro)-1e-5);
    %%  objective function
    f = zeros(ps,2);
    f(:,1) = (Q.*Po./0.7+Ef)./12;
    f(:,2) = gamma./(gg.*Po).*(Q./(2.*pi.*R.*h));
    %%  constraints
    g(:,1) = Ws-W;
    g(:,2) = Po-Pmax;
    g(:,3) = delT-delTmax;
    g(:,4) = hmin-h;
    g(:,5) = Ro-R;
    g(:,6) = f(:,2)-0.001;
    g(:,7) = W./(pi.*(R.^2-Ro.^2)+1e-5)-5000;
    h      = zeros(ps,0);
elseif func == 21
    %% Crash energy management for high-speed train
    x1 = x(:,1); x2 = x(:,2); x3 = x(:,3);
    x4 = x(:,4); x5 = x(:,5); x6 = x(:,6);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 1.3667145844797-0.00904459793976106*x1-0.0016193573938033*x2-0.00758531275221425*x3-0.00440727360327102*x4-0.00572216860791644*x5-0.00936039926190721*x6+2.62510221107328*10^(-6)*(x1.^2)+4.92982681358861*10^(-7)*(x2.^2)+2.25524989067108*10^(-6)*(x3.^2)+...
    1.84605439400301*10^(-6)*(x4.^2)+2.17175358243416*10^(-6)*(x5.^2)+3.90158043948054*10^(-6)*(x6.^2)+4.55276994245781*10^(-7)*x1.*x2-6.37013576290982*10^(-7)*x1.*x3+8.26736480446359*10^(-7)*x1.*x4+5.66352809442276*10^(-8)*x1.*x5-3.20213897443278*10^(-7)*x1.*x6+...
    1.18015467772812*10^(-8)*x2.*x3+9.25820391546515*10^(-8)*x2.*x4-1.05705364119837*10^(-7)*x2.*x5-4.74797783014687*10^(-7)*x2.*x6-5.02319867013788*10^(-7)*x3.*x4+9.54284258085225*10^(-7)*x3.*x5+1.80533309229454*10^(-7)*x3.*x6-1.07938022118477*10^(-6)*x4.*x5-...
    1.81370642220182*10^(-7)*x4.*x6-2.24238851688047*10^(-7)*x5.*x6; 
    f(:,2) = -1.19896668942683+3.04107017009774*x1+1.23535701600191*x2+2.13882039381528*x3+2.33495178382303*x4+2.68632494801975*x5+3.43918953617606*x6-7.89144544980703*10^(-4)*(x1.^2)-2.06085185698215*10^(-4)*(x2.^2)-7.15269900037858*10^(-4)*(x3.^2)-7.8449237573837*10^(-4)*(x4.^2)-...
    9.31396896237177*10^(-4)*(x5.^2)-1.40826531972195*10^(-3)*(x6.^2)-1.60434988248392*10^(-4)*x1.*x2+2.0824655419411*10^(-4)*x1.*x3-3.0530659653553*10^(-4)*x1.*x4-8.10145973591615*10^(-5)*x1.*x5+6.94728759651311*10^(-5)*x1.*x6+1.18015467772812*10^(-8)*x2.*x3+...
    9.25820391546515*10^(-8)*x2.*x4-1.05705364119837*10^(-7)*x2.*x5+1.69935290196781*10^(-4)*x2.*x6+2.32421829190088*10^(-5)*x3.*x4-2.0808624041163476*10^(-4)*x3.*x5+1.75576341867273*10^(-5)*x3.*x6+2.68422081654044*10^(-4)*x4.*x5+4.39852066801981*10^(-5)*x4.*x6+...
    2.96785446021357*10^(-5)*x5.*x6;
    %% constraints
    g = zeros(ps,4);
    h = zeros(ps,0);
    g(:,1) = f(:,1)-5;
    g(:,2) = -f(:,1);
    g(:,3) = f(:,2) - 28;
    g(:,4) = -f(:,2);
%% chemical problems
elseif func == 22
   %% Haverly's Pooling Problem
   x1 = x(:,1); x2 = x(:,2); x3 = x(:,3);
   x4 = x(:,4); x5 = x(:,5); x6 = x(:,6);
   x7 = x(:,7); x8 = x(:,8); x9 = x(:,9);
   %% objective function
   f = zeros(ps,2);
   f(:,1) = -9*x1-15*x2+6*x3+16*x4;
   f(:,2) = 10.*(x5+x6);
   %% constraints
   g = zeros(ps,2);
   h = zeros(ps,4);
   g(:,1) = x9.*x7+2*x5-2.5*x1;
   g(:,2) = x9.*x8+2*x6-1.5*x2;
   h(:,1) = x7+x8-x4-x3;
   h(:,2) = x1-x5-x7;
   h(:,3) = x2-x6-x8;
   h(:,4) = x9.*x7+x9.*x8-3.*x3-x4;
elseif func == 23
    %% Reactor Network Design
    k1 = 0.09755988; k2 = 0.99*k1;
    k3 = 0.0391908; k4 = 0.9*k3;
    x1 = x(:,1); x2 = x(:,2); x3 = x(:,3);
    x4 = x(:,4); x5 = x(:,5); x6 = x(:,6);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = -x4;
    f(:,2) = x5.^(0.5)+x6.^(0.5);
    %% constraints
    g = zeros(ps,1);
    h = zeros(ps,4);
    g(:,1) = f(:,2)-4;
    h(:,1) = k1.*x5.*x2 + x1 -1;
    h(:,2) = k3.*x5.*x3+x3+x1-1;
    h(:,3) = k2.*x6.*x2 - x1 + x2;
    h(:,4) = k4.*x6.*x4 + x2-x1+x4-x3;
elseif func == 24
    %% Heat Exchanger Network Design
    x1 = x(:,1); x2 = x(:,2); x3 = x(:,3); x4 = x(:,4); x5 = x(:,5);
    x6 = x(:,6); x7 = x(:,7); x8 = x(:,8); x9 = x(:,9);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 35.*x1.^(0.6)+ 35.*x2.^(0.6);
    f(:,2) = 200.*x1.*x4-x3;
    f(:,3) = 200.*x2.*x6-x5;
    %% constraints
    g = zeros(ps,0);
    h = zeros(ps,6);
    h(:,1) = x3 - 1e4.*(x7-100);
    h(:,2) = x5 - 1e4.*(300-x7);
    h(:,3) = x3 - 1e4.*(600-x8);
    h(:,4) = x5 - 1e4.*(900-x9);
    h(:,5) = x4.*log(abs(x8-100)+1e-6)-x4.*log(abs(600-x7)+1e-6)-x8+x7+500;
    h(:,6) = x6.*log(abs(x9-x7)+1e-6)-x6.*log(600)-x9+x7+600;
%% process Design and Synthesis
elseif func == 25
    %% process synthesis problem
    x1 = x(:,1); x2 = round(x(:,2));
    %% objective function
    f = zeros(ps,2);
    f(:,1) = x2 + 2*x1;
    f(:,2) = -x1.^2 -x2;
    %% constraints
    g = zeros(ps,2);
    h = zeros(ps,0);
    g(:,1) = f(:,2) +1.25;
    g(:,2) = x1 + x2 -1.6;
elseif func == 26
    %% Process sythesis and Design Problems
    x1 = x(:,1); x2 = x(:,2); x3 = round(x(:,3));
    %% objective function
    f = zeros(ps,2);
    f(:,1) = -x3 + x2 + 2*x1;
    f(:,2) = -x1.^2 - x2 + x1.*x3;
    %% constraints
    h = zeros(ps,1);
    g = zeros(ps,1);
    h(:,1) = -2.*exp(-x2) + x1;
    g(:,1) = x2 - x1 + x3;
elseif func == 27
    %% Process flow sheeting Problem
    x1 = x(:,1); x2 = x(:,2); x3 = x(:,3);
    %% objective function
    f = zeros(ps,2);
    f(:,1) = -0.7.*x3 + 0.8 + 5.*(0.5 - x1).^2;
    f(:,2) = x1 - x3;
    %% constraints
    g = zeros(ps,3);
    h = zeros(ps,0);
    g(:,1) = -(exp(x1 - 0.2) + x2);
    g(:,2) = x2 + 1.1.*x3 - 1;
    g(:,3) = x1 - x3 - 0.2;
elseif func == 28
    %% Two reactor Problem
    x1 = x(:,1);
    x2 = x(:,2);
    v1 = x(:,3);
    v2 = x(:,4);
    y1 = round(x(:,5));
    y2 = round(x(:,6));
    x_ = x(:,7);
        
    z1 = 0.9*(1-exp(-0.5.*v1)).*x1;
    z2 = 0.8*(1-exp(-0.4*v2)).*x2;
    %% objective function
    f = zeros(ps,2);
    f(:,1) = 7.5.*y1 + 5.5.*y2 + 7.*v1 + 6.*v2 + 5.*x_;
    f(:,2) = x1 + x2;
    %% constraints
    g = zeros(ps,4);
    h = zeros(ps,4);
    h(:,1) = y1 + y2 - 1;
    h(:,2) = z1 + z2 - 10;
    h(:,3) = x1 + x2 -x_;
    h(:,4) = z1.*y1 + z2.*y2 - 10;
    g(:,1) = v1 - 10*y1 -1e-6;
    g(:,2) = v2 - 10*y2;
    g(:,3) = x1 - 20*y1;
    g(:,4) = x2 - 20*y2;
elseif func == 29
    %% process synthesis problem
    x1 = x(:,1); x2 = x(:,2); x3 = x(:,3); x4 = round(x(:,4));
    x5 = round(x(:,5)); x6 = round(x(:,6)); x7 = round(x(:,7));
    %% objective function
    f = zeros(ps,2);
    f(:,1) = (1-x4).^2 + (1-x5).^2 + (1-x6).^2 - log(abs(1+x7)+1e-6);
    f(:,2) = (1-x1).^2 + (2-x2).^2 + (3-x3).^2;
    %% constraints
    g = zeros(ps,9);
    h = zeros(ps,0);
    g(:,1) = x1 + x2 + x3 + x4 + x5 + x6 -5;
    g(:,2) = x6.^3 + x1.^2 + x2.^2 + x3.^2 - 5.5;
    g(:,3) = x1 + x4 - 1.2;
    g(:,4) = x2 + x5 - 1.8;
    g(:,5) = x3 + x6 - 2.5;
    g(:,6) = x1 + x7 - 1.2;
    g(:,7) = x5.^2 + x2.^2 - 1.64;
    g(:,8) = x6.^2 + x3.^2 - 4.25;
    g(:,9) = x5.^2 + x3.^2 - 4.64;
%% Power electronics Problem
elseif (func == 30)
    %% SOPWM for 3-level Invereters
    m = 0.32;
    s = (-ones(1,25)).^(2:26);
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);

elseif (func == 31)
    %% SOPWM for 5-level Inverters
    m = 0.32;
    s = [1,-1,1,1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,1,-1,-1,1,-1,1,1,-1];
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);
elseif (func == 32)
    %% SOPWM for 7-level Inverters
    m = 0.36;
    s = [1,-1,1,1,1,-1,-1,-1,1,1,-1,-1,1,1,1,-1,-1,-1,1,1,-1,-1,1,1,1];
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);

elseif (func == 33)
    %% SOPWM for 9-level Inverters
    m = 0.32;
    s = [1,1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,-1,1];
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);

elseif (func == 34)
    %% SOPWM for 11-level Inverters
    m = 0.3333;
    s = [1,-1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,1,-1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1];
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);

elseif (func == 35)
    %% SOPWM for 13-level Inverters
    m = 0.32;
    s = [1,1,1,-1,1,-1,1,-1,1,1,1,1,-1,-1,-1,-1,1,-1,1,-1,1,1,1,1,-1,-1,-1,1,-1,1];
    k = [5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,65,67,71,73,77,79,83,85,91,95,97];
    %% objective function
    f = zeros(ps,2);
    for i = 1:ps
        su = 0;
        for j = 1:31
            su2 = 0;
            for l = 1:D
                su2 = su2 + s(l).*cos(k(j).*x(i,l)*pi/180);
            end
            su = su + su2.^2./k(j).^4;
        end
        f(i,1) = (su).^0.5./(sum(1./k.^4)).^0.5;
    end
    f(:,2) = (sum(s.*cos(x*pi/180),2)-m).^2;
    %% constraints
    g = zeros(ps,D-1);
    for i = 1:D-1
        g(:,i) = x(:,i)-x(:,i+1)+1e-6;
    end
    h = zeros(ps,0);
%% Power System Problems
elseif(func == 36)
    %% Optimal Sizing of Single Phase Distributed Generation with reactive power support for Phase Balancing at Main Transformer/Grid and active Power loss
    G = [   2.0336507971433414e+02  -5.3956475914255392e+01  -2.7088978087868369e+01  -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -5.3956475914255392e+01   2.3398757254504045e+02  -8.6283054943635207e+01   5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.7088978087868366e+01  -8.6283054943635207e+01   2.2201347979167249e+02   2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   9.6523494572590857e+02  -2.1701526742738102e+02  -1.1958512736147634e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01;
            5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01  -2.1701526742738102e+02   1.0650133220777063e+03  -3.3574578008216434e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01;
            2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02  -1.1958512736147634e+02  -3.3574578008216429e+02   1.0272843110747488e+03   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   8.1346031885503260e+02  -2.1582590365702157e+02  -1.0835591235147348e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -2.1582590365702157e+02   9.3595029015712180e+02  -3.4513221977454083e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -1.0835591235147346e+02  -3.4513221977454083e+02   8.8805391916438600e+02   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   4.0673015942751630e+02  -1.0791295182851078e+02  -5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -1.0791295182851078e+02   4.6797514507856090e+02  -1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -5.4177956175736732e+01  -1.7256610988727041e+02   4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.5513970658463421e+02  -5.5145839684614856e+01  -3.8318193097871237e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.5145839684614856e+01   3.6305060445986504e+02  -7.6896615251258694e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.8318193097871237e+01  -7.6896615251258680e+01   3.6124387170145928e+02];
    B = [  -3.5113004928555353e+02   4.3573978441589354e+01   3.1816722979531573e+01   3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.3573978441589354e+01  -3.5377814658607412e+02   5.8917529889855743e+01  -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.1816722979531573e+01   5.8917529889855743e+01  -3.5272127849600997e+02  -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01  -1.3556671476971078e+03   1.3185933449564033e+02   1.0092116565621727e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00;
           -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   1.3185933449564033e+02  -1.3531674012165354e+03   1.7296810353963031e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00;
           -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   1.0092116565621727e+02   1.7296810353963031e+02  -1.3538611528970828e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -1.4045201971422141e+03   1.7429591376635742e+02   1.2726689191812629e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   1.7429591376635742e+02  -1.4151125863442965e+03   2.3567011955942297e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   1.2726689191812629e+02   2.3567011955942297e+02  -1.4108851139840399e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -7.0226009857110705e+02   8.7147956883178708e+01   6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   8.7147956883178708e+01  -7.0755629317214823e+02   1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   6.3633445959063145e+01   1.1783505977971149e+02  -7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0227699984044705e+02   1.1373991708722637e+00   5.4709967176225547e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.1373991708722739e+00  -2.9183296145831315e+02  -3.7844861299369055e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4709967176225582e+00  -3.7844861299369024e+00  -2.9569731740905274e+02];
    P = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -3.5999999999999999e-01;
           -2.8799999999999998e-01;
           -4.1999999999999998e-01;
           -5.7599999999999996e-01;
           -4.8000000000000001e-02;
           -4.7999999999999998e-01;
           -4.3200000000000000e-01;
           -2.8799999999999998e-01;
           -3.5999999999999999e-01];
    Q = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -2.1600000000000000e-01;
           -1.9200000000000000e-01;
           -2.6400000000000001e-01;
           -4.3200000000000000e-01;
           -3.3599999999999998e-02;
           -2.9999999999999999e-01;
           -2.8799999999999998e-01;
           -1.9200000000000000e-01;
           -2.3999999999999999e-01];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(15,1);
    V(1)    = 1.00;
    V(2)    = 1.00*exp(1j*4*pi/3);
    V(3)    = 1.00*exp(1j*2*pi/3);
    Pdg     = zeros(15,1);
    Qdg     = zeros(15,1);
    for i = 1:ps
        V(4:15)   = x(i,1:12)+1j*x(i,13:24);
        Pdg([7,15]) = x(i,25:26);
        Qdg([7,15]) = x(i,27:28);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pdg-P;
        delQ = Qsp-Qdg-Q;
    %% objective calculation
       f(i,1) = abs(I(1)+I(2)+I(3))+abs(I(1)+exp(1j*4*pi/3)*I(2)+exp(1j*2*pi/3)*I(3));
       f(i,2) = sum(Psp);
       h(i,:) = [delP(4:15)',delQ(4:15)'];
    end
    g = zeros(ps,0);
elseif(func == 37)
    %% Optimal Sizing of Single Phase Distributed Generation with reactive power support for Phase Balancing at Main Transformer/Grid and reactive Power loss
    G = [   2.0336507971433414e+02  -5.3956475914255392e+01  -2.7088978087868369e+01  -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -5.3956475914255392e+01   2.3398757254504045e+02  -8.6283054943635207e+01   5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.7088978087868366e+01  -8.6283054943635207e+01   2.2201347979167249e+02   2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   9.6523494572590857e+02  -2.1701526742738102e+02  -1.1958512736147634e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01;
            5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01  -2.1701526742738102e+02   1.0650133220777063e+03  -3.3574578008216434e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01;
            2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02  -1.1958512736147634e+02  -3.3574578008216429e+02   1.0272843110747488e+03   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   8.1346031885503260e+02  -2.1582590365702157e+02  -1.0835591235147348e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -2.1582590365702157e+02   9.3595029015712180e+02  -3.4513221977454083e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -1.0835591235147346e+02  -3.4513221977454083e+02   8.8805391916438600e+02   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   4.0673015942751630e+02  -1.0791295182851078e+02  -5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -1.0791295182851078e+02   4.6797514507856090e+02  -1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -5.4177956175736732e+01  -1.7256610988727041e+02   4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.5513970658463421e+02  -5.5145839684614856e+01  -3.8318193097871237e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.5145839684614856e+01   3.6305060445986504e+02  -7.6896615251258694e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.8318193097871237e+01  -7.6896615251258680e+01   3.6124387170145928e+02];
    B = [  -3.5113004928555353e+02   4.3573978441589354e+01   3.1816722979531573e+01   3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.3573978441589354e+01  -3.5377814658607412e+02   5.8917529889855743e+01  -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.1816722979531573e+01   5.8917529889855743e+01  -3.5272127849600997e+02  -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01  -1.3556671476971078e+03   1.3185933449564033e+02   1.0092116565621727e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00;
           -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   1.3185933449564033e+02  -1.3531674012165354e+03   1.7296810353963031e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00;
           -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   1.0092116565621727e+02   1.7296810353963031e+02  -1.3538611528970828e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -1.4045201971422141e+03   1.7429591376635742e+02   1.2726689191812629e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   1.7429591376635742e+02  -1.4151125863442965e+03   2.3567011955942297e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   1.2726689191812629e+02   2.3567011955942297e+02  -1.4108851139840399e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -7.0226009857110705e+02   8.7147956883178708e+01   6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   8.7147956883178708e+01  -7.0755629317214823e+02   1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   6.3633445959063145e+01   1.1783505977971149e+02  -7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0227699984044705e+02   1.1373991708722637e+00   5.4709967176225547e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.1373991708722739e+00  -2.9183296145831315e+02  -3.7844861299369055e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4709967176225582e+00  -3.7844861299369024e+00  -2.9569731740905274e+02];
    P = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -3.5999999999999999e-01;
           -2.8799999999999998e-01;
           -4.1999999999999998e-01;
           -5.7599999999999996e-01;
           -4.8000000000000001e-02;
           -4.7999999999999998e-01;
           -4.3200000000000000e-01;
           -2.8799999999999998e-01;
           -3.5999999999999999e-01];
    Q = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -2.1600000000000000e-01;
           -1.9200000000000000e-01;
           -2.6400000000000001e-01;
           -4.3200000000000000e-01;
           -3.3599999999999998e-02;
           -2.9999999999999999e-01;
           -2.8799999999999998e-01;
           -1.9200000000000000e-01;
           -2.3999999999999999e-01];

    Y = G+1j*B;
    %% voltage initilization
    V = zeros(15,1);
    V(1)    = 1.00;
    V(2)    = 1.00*exp(1j*4*pi/3);
    V(3)    = 1.00*exp(1j*2*pi/3);
    Pdg     = zeros(15,1);
    Qdg     = zeros(15,1);
    for i = 1:ps
        V(4:15)   = x(i,1:12)+1j*x(i,13:24);
        Pdg([7,15]) = x(i,25:26);
        Qdg([7,15]) = x(i,27:28);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pdg-P;
        delQ = Qsp-Qdg-Q;
    %% objective calculation
       f(i,1) = abs(I(1)+I(2)+I(3))+abs(I(1)+exp(1j*4*pi/3)*I(2)+exp(1j*2*pi/3)*I(3));
       f(i,2) = sum(Qsp);
       h(i,:) = [delP(4:15)',delQ(4:15)'];
    end
    g = zeros(ps,0);
elseif(func == 38)
    %% Optimal Sizing of Single Phase Distributed Generation with reactive power support for active and reactive Power loss
    G = [   2.0336507971433414e+02  -5.3956475914255392e+01  -2.7088978087868369e+01  -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -5.3956475914255392e+01   2.3398757254504045e+02  -8.6283054943635207e+01   5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.7088978087868366e+01  -8.6283054943635207e+01   2.2201347979167249e+02   2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   9.6523494572590857e+02  -2.1701526742738102e+02  -1.1958512736147634e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01;
            5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01  -2.1701526742738102e+02   1.0650133220777063e+03  -3.3574578008216434e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01;
            2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02  -1.1958512736147634e+02  -3.3574578008216429e+02   1.0272843110747488e+03   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   8.1346031885503260e+02  -2.1582590365702157e+02  -1.0835591235147348e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -2.1582590365702157e+02   9.3595029015712180e+02  -3.4513221977454083e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -1.0835591235147346e+02  -3.4513221977454083e+02   8.8805391916438600e+02   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   4.0673015942751630e+02  -1.0791295182851078e+02  -5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -1.0791295182851078e+02   4.6797514507856090e+02  -1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -5.4177956175736732e+01  -1.7256610988727041e+02   4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.5513970658463421e+02  -5.5145839684614856e+01  -3.8318193097871237e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.5145839684614856e+01   3.6305060445986504e+02  -7.6896615251258694e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.8318193097871237e+01  -7.6896615251258680e+01   3.6124387170145928e+02];
    B = [  -3.5113004928555353e+02   4.3573978441589354e+01   3.1816722979531573e+01   3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.3573978441589354e+01  -3.5377814658607412e+02   5.8917529889855743e+01  -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.1816722979531573e+01   5.8917529889855743e+01  -3.5272127849600997e+02  -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01  -1.3556671476971078e+03   1.3185933449564033e+02   1.0092116565621727e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00;
           -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   1.3185933449564033e+02  -1.3531674012165354e+03   1.7296810353963031e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00;
           -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   1.0092116565621727e+02   1.7296810353963031e+02  -1.3538611528970828e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -1.4045201971422141e+03   1.7429591376635742e+02   1.2726689191812629e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   1.7429591376635742e+02  -1.4151125863442965e+03   2.3567011955942297e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   1.2726689191812629e+02   2.3567011955942297e+02  -1.4108851139840399e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -7.0226009857110705e+02   8.7147956883178708e+01   6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   8.7147956883178708e+01  -7.0755629317214823e+02   1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   6.3633445959063145e+01   1.1783505977971149e+02  -7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0227699984044705e+02   1.1373991708722637e+00   5.4709967176225547e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.1373991708722739e+00  -2.9183296145831315e+02  -3.7844861299369055e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4709967176225582e+00  -3.7844861299369024e+00  -2.9569731740905274e+02];
    P = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -3.5999999999999999e-01;
           -2.8799999999999998e-01;
           -4.1999999999999998e-01;
           -5.7599999999999996e-01;
           -4.8000000000000001e-02;
           -4.7999999999999998e-01;
           -4.3200000000000000e-01;
           -2.8799999999999998e-01;
           -3.5999999999999999e-01];
    Q = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -2.1600000000000000e-01;
           -1.9200000000000000e-01;
           -2.6400000000000001e-01;
           -4.3200000000000000e-01;
           -3.3599999999999998e-02;
           -2.9999999999999999e-01;
           -2.8799999999999998e-01;
           -1.9200000000000000e-01;
           -2.3999999999999999e-01];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(15,1);
    V(1)    = 1.00;
    V(2)    = 1.00*exp(1j*4*pi/3);
    V(3)    = 1.00*exp(1j*2*pi/3);
    Pdg     = zeros(15,1);
    Qdg     = zeros(15,1);
    for i = 1:ps
        V(4:15)   = x(i,1:12)+1j*x(i,13:24);
        Pdg([7,15]) = x(i,25:26);
        Qdg([7,15]) = x(i,27:28);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pdg-P;
        delQ = Qsp-Qdg-Q;
    %% objective calculation
       f(i,1) = sum(Qsp);
       f(i,2) = sum(Psp);
       h(i,:) = [delP(4:15)',delQ(4:15)'];
    end
    g = zeros(ps,0);
elseif(func == 39)
    %% Optimal Sizing of Single Phase Distributed Generation with reactive power support for Phase Balancing at Main Transformer/Grid and active and reactive Power loss
    G = [   2.0336507971433414e+02  -5.3956475914255392e+01  -2.7088978087868369e+01  -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -5.3956475914255392e+01   2.3398757254504045e+02  -8.6283054943635207e+01   5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.7088978087868366e+01  -8.6283054943635207e+01   2.2201347979167249e+02   2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -2.0336507971375815e+02   5.3956475914255392e+01   2.7088978087868369e+01   9.6523494572590857e+02  -2.1701526742738102e+02  -1.1958512736147634e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01;
            5.3956475914255392e+01  -2.3398757253928045e+02   8.6283054943635207e+01  -2.1701526742738102e+02   1.0650133220777063e+03  -3.3574578008216434e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01;
            2.7088978087868366e+01   8.6283054943635207e+01  -2.2201347979109650e+02  -1.1958512736147634e+02  -3.3574578008216429e+02   1.0272843110747488e+03   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   8.1346031885503260e+02  -2.1582590365702157e+02  -1.0835591235147348e+02  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -2.1582590365702157e+02   9.3595029015712180e+02  -3.4513221977454083e+02   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -1.0835591235147346e+02  -3.4513221977454083e+02   8.8805391916438600e+02   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -4.0673015942751630e+02   1.0791295182851078e+02   5.4177956175736739e+01   4.0673015942751630e+02  -1.0791295182851078e+02  -5.4177956175736739e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0791295182851078e+02  -4.6797514507856090e+02   1.7256610988727041e+02  -1.0791295182851078e+02   4.6797514507856090e+02  -1.7256610988727041e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4177956175736732e+01   1.7256610988727041e+02  -4.4402695958219300e+02  -5.4177956175736732e+01  -1.7256610988727041e+02   4.4402695958219300e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.5513970658463421e+02   5.5145839684614856e+01   3.8318193097871237e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.5513970658463421e+02  -5.5145839684614856e+01  -3.8318193097871237e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.5145839684614856e+01  -3.6305060445986504e+02   7.6896615251258694e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.5145839684614856e+01   3.6305060445986504e+02  -7.6896615251258694e+01;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.8318193097871237e+01   7.6896615251258680e+01  -3.6124387170145928e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.8318193097871237e+01  -7.6896615251258680e+01   3.6124387170145928e+02];
    B = [  -3.5113004928555353e+02   4.3573978441589354e+01   3.1816722979531573e+01   3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.3573978441589354e+01  -3.5377814658607412e+02   5.8917529889855743e+01  -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.1816722979531573e+01   5.8917529889855743e+01  -3.5272127849600997e+02  -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            3.5113004928555353e+02  -4.3573978441589354e+01  -3.1816722979531573e+01  -1.3556671476971078e+03   1.3185933449564033e+02   1.0092116565621727e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00;
           -4.3573978441589354e+01   3.5377814658607412e+02  -5.8917529889855743e+01   1.3185933449564033e+02  -1.3531674012165354e+03   1.7296810353963031e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00;
           -3.1816722979531573e+01  -5.8917529889855743e+01   3.5272127849600997e+02   1.0092116565621727e+02   1.7296810353963031e+02  -1.3538611528970828e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -1.4045201971422141e+03   1.7429591376635742e+02   1.2726689191812629e+02   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   1.7429591376635742e+02  -1.4151125863442965e+03   2.3567011955942297e+02  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   1.2726689191812629e+02   2.3567011955942297e+02  -1.4108851139840399e+03  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   7.0226009857110705e+02  -8.7147956883178708e+01  -6.3633445959063145e+01  -7.0226009857110705e+02   8.7147956883178708e+01   6.3633445959063145e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -8.7147956883178708e+01   7.0755629317214823e+02  -1.1783505977971149e+02   8.7147956883178708e+01  -7.0755629317214823e+02   1.1783505977971149e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -6.3633445959063145e+01  -1.1783505977971149e+02   7.0544255699201995e+02   6.3633445959063145e+01   1.1783505977971149e+02  -7.0544255699201995e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0227699984044705e+02  -1.1373991708722637e+00  -5.4709967176225547e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0227699984044705e+02   1.1373991708722637e+00   5.4709967176225547e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1373991708722739e+00   2.9183296145831315e+02   3.7844861299369055e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.1373991708722739e+00  -2.9183296145831315e+02  -3.7844861299369055e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4709967176225582e+00   3.7844861299369024e+00   2.9569731740905274e+02   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.4709967176225582e+00  -3.7844861299369024e+00  -2.9569731740905274e+02];
    P = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -3.5999999999999999e-01;
           -2.8799999999999998e-01;
           -4.1999999999999998e-01;
           -5.7599999999999996e-01;
           -4.8000000000000001e-02;
           -4.7999999999999998e-01;
           -4.3200000000000000e-01;
           -2.8799999999999998e-01;
           -3.5999999999999999e-01];
    Q = [  -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -0.0000000000000000e+00;
           -2.1600000000000000e-01;
           -1.9200000000000000e-01;
           -2.6400000000000001e-01;
           -4.3200000000000000e-01;
           -3.3599999999999998e-02;
           -2.9999999999999999e-01;
           -2.8799999999999998e-01;
           -1.9200000000000000e-01;
           -2.3999999999999999e-01];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(15,1);
    V(1)    = 1.00;
    V(2)    = 1.00*exp(1j*4*pi/3);
    V(3)    = 1.00*exp(1j*2*pi/3);
    Pdg     = zeros(15,1);
    Qdg     = zeros(15,1);
    for i = 1:ps
        V(4:15)   = x(i,1:12)+1j*x(i,13:24);
        Pdg([7,15]) = x(i,25:26);
        Qdg([7,15]) = x(i,27:28);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pdg-P;
        delQ = Qsp-Qdg-Q;
    %% objective calculation
       f(i,1) = abs(I(1)+I(2)+I(3))+abs(I(1)+exp(1j*4*pi/3)*I(2)+exp(1j*2*pi/3)*I(3));
       f(i,2) = sum(Psp);
       f(i,3) = sum(Qsp);
       h(i,:) = [delP(4:15)',delQ(4:15)'];
    end
    g = zeros(ps,0);
elseif(func == 40)
    %% Optimal Power flow (Minimization of Active and Reactive Power Loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];


    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,2) = imag(V(1).*conj(I(2)))+sum(Qsp(2:14));
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif(func == 41)
    %% Optimal Power flow (Minimization of voltage deviation, Active and Reactive Power Loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,2) = imag(V(1).*conj(I(2)))+sum(Qsp(2:14));
       f(i,3) = sum((1-abs(V(2:14))).^2);
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif(func == 42)
    %% Optimal Power flow (Minimization of voltage deviation, Active and Reactive Power Loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,2) = sum((1-abs(V(2:14))).^2);
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif (func == 43)
    %% Optimal Power flow (Minimization of Fuel Cost, active power loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    ng      = [1,2,3,6,8];
    a1      = [0,0,0,0,0];
    b1      = [ 2, 1.75,1,3.25,3];
    c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = sum(a1 + b1.*Pg(ng)' + c1.*(Pg(ng).^2)');
       f(i,2) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif (func == 44)
    %% Optimal Power flow (Minimization of Fuel Cost, active and reactive power loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    ng      = [1,2,3,6,8];
    a1      = [0,0,0,0,0];
    b1      = [ 2, 1.75,1,3.25,3];
    c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = sum(a1 + b1.*Pg(ng)' + c1.*(Pg(ng).^2)');
       f(i,2) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,3) = imag(V(1).*conj(I(1)))+sum(Qsp(2:14));
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif (func == 45)
    %% Optimal Power flow (Minimization of Fuel Cost, voltage deviation and active power loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    ng      = [1,2,3,6,8];
    a1      = [0,0,0,0,0];
    b1      = [ 2, 1.75,1,3.25,3];
    c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = sum(a1 + b1.*Pg(ng)' + c1.*(Pg(ng).^2)');
       f(i,2) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,3) = sum((1-abs(V(2:14))).^2);
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
elseif (func == 46)
    %% Optimal Power flow (Minimization of Fuel Cost, voltage deviation, active and reactive power loss)
    G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
           -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
    B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
            0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
    P = [   0.0000000000000000e+00;
            2.1700000000000000e-01;
            9.4200000000000006e-01;
            4.7799999999999998e-01;
            7.5999999999999998e-02;
            1.1199999999999999e-01;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            2.9499999999999998e-01;
            8.9999999999999997e-02;
            3.5000000000000003e-02;
            6.0999999999999999e-02;
            1.3500000000000001e-01;
            1.4899999999999999e-01];
    Q = [   0.0000000000000000e+00;
            1.2700000000000000e-01;
            1.9000000000000000e-01;
           -3.9000000000000000e-02;
            1.6000000000000000e-02;
            7.4999999999999997e-02;
            0.0000000000000000e+00;
            0.0000000000000000e+00;
            1.6600000000000001e-01;
            5.7999999999999996e-02;
            1.8000000000000002e-02;
            1.6000000000000000e-02;
            5.7999999999999996e-02;
            5.0000000000000003e-02];
    Y = G+1j*B;
    %% voltage initilization
    V = zeros(14,1);
    V(1)    = 1;
    Pg      = zeros(14,1);
    Qg      = zeros(14,1);
    ng      = [1,2,3,6,8];
    a1      = [0,0,0,0,0];
    b1      = [ 2, 1.75,1,3.25,3];
    c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];
    for i = 1:ps
        V(2:14)   = x(i,1:13)+ 1j*x(i,14:26);
        Pg([2,3,6,8]) = x(i,27:30);
        Qg([2,3,6,8]) = x(i,31:34);
    %% current calculation
        I    = Y*V;
        S    = V.*conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
    %% objective calculation
       f(i,1) = sum(a1 + b1.*Pg(ng)' + c1.*(Pg(ng).^2)');
       f(i,2) = real(V(1).*conj(I(1)))+sum(Psp(2:14));
       f(i,3) = imag(V(1).*conj(I(1)))+sum(Qsp(2:14));
       f(i,4) = sum((1-abs(V(2:14))).^2);
       h(i,:) = [delP(2:14)',delQ(2:14)'];
    end
    g = zeros(ps,0);
    
elseif (func == 47)
    %% Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
   P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
           3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];

    %% voltage initilization
    V = zeros(6,1);
    V(1)    = 1;
    Pc     = zeros(6,1);
    Qc     = zeros(6,1);
    for i = 1:ps
        V(2:6)   = x(i,1:5)+1j*x(i,6:10);
        w         = x(i,11);
        V(1)      = x(i,12)+1e-5;
        Pc([4,5,6]) = x(i,13:15);
        Qc([4,5,6]) = x(i,16:18);
    %% current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);
        Psp  = Pc.*(1-w)-P(:,1).*(abs(V)./P(:,5)).^P(:,6);
        Qsp  = Qc.*(1-sqrt(Vr.^2+Vm.^2))-Q(:,1).*(abs(V)./Q(:,5)).^Q(:,6);
        spI  = conj((Psp+1j*Qsp)./V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;
    %% objective calculation
       f(i,1) = sum(Psp) ;
       f(i,2) = sum(Qsp) ;
       h(i,:) = [delIr(1:6)',delIm(1:6)'];
    end
    g = zeros(ps,0); 
    
elseif (func == 48)
    %% Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
   P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
           3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];
    %% voltage initilization
    V = zeros(6,1);
    V(1)    = 1;
    Pc     = zeros(6,1);
    Qc     = zeros(6,1);
    for i = 1:ps
        V(2:6)   = x(i,1:5)+1j*x(i,6:10);
        w         = x(i,11);
        V(1)      = x(i,12)+1e-5;
        Pc([4,5,6]) = x(i,13:15);
        Qc([4,5,6]) = x(i,16:18);
    %% current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);
        Psp  = Pc.*(1-w)-P(:,1).*(abs(V)./P(:,5)).^P(:,6);
        Qsp  = Qc.*(1-sqrt(Vr.^2+Vm.^2))-Q(:,1).*(abs(V)./Q(:,5)).^Q(:,6);
        spI  = conj((Psp+1j*Qsp)./V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;
    %% objective calculation
       f(i,1) = sum(Psp) ;
       f(i,2) = sum((1-abs(V)).^2) ;
       h(i,:) = [delIr(1:6)',delIm(1:6)'];
    end
    g = zeros(ps,0); 
elseif (func == 49)
    %% Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
   P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
           0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
   L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
           2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
           3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];
    %% voltage initilization
    V = zeros(6,1);
    V(1)    = 1;
    Pc     = zeros(6,1);
    Qc     = zeros(6,1);
    for i = 1:ps
        V(2:6)   = x(i,1:5)+1j*x(i,6:10);
        w         = x(i,11);
        V(1)      = x(i,12)+1e-5;
        Pc([4,5,6]) = x(i,13:15);
        Qc([4,5,6]) = x(i,16:18);
    %% current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);
        Psp  = Pc.*(1-w)-P(:,1).*(abs(V)./P(:,5)).^P(:,6);
        Qsp  = Qc.*(1-sqrt(Vr.^2+Vm.^2))-Q(:,1).*(abs(V)./Q(:,5)).^Q(:,6);
        spI  = conj((Psp+1j*Qsp)./V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;
    %% objective calculation
       f(i,1) = sum(Psp) ;
       f(i,2) = sum(Qsp) ;
       f(i,3) = sum((1-abs(V)).^2) ;
       h(i,:) = [delIr(1:6)',delIm(1:6)'];
    end
    g = zeros(ps,0); 
elseif func == 50
    %% Power Distribution System Planning
    N = D;
    P = x;
    PD = 1200;
    B = [140 17 15 19 26 22;
        17 60 13 16 15 20;
        15 13 65 17 24 19;
        19 16 17 71 30 25;
        26 15 24 30 69 32;
        22 20 19 25 32 85] * 10^-6;
    a = [756.7988 451.3251 1243.5311 1049.9977 1356.6592 1658.5696];
    b = [38.5390  46.1591 38.3055  40.3965 38.2704 36.3278];
    c = [0.15247  0.10587  0.03546  0.02803  0.01799 0.02111];
    alpha = [13.8593 13.8593  40.2669  40.2669 42.8955 42.8955];
    beta = [0.32767  0.32767 -0.54551 -0.54551 -0.51116 -0.51116];
    gamma = [0.00419 0.00419  0.00683  0.00683 0.00461 0.00461];
    
    PL = zeros(ps,1);
    for i = 1:N
        for j = 1:N
            PL = PL + P(:,i) .* B(i,j) .* P(j);
        end
    end
    
    % objectives
    f = zeros(ps,2);
    for i = 1:N
        f(:,1) = f(:,1) + a(i) + b(i) .* P(:,i) + c(i) .* P(:,i).^2 ;
    end
    for i = 1:N
        f(:,2) = f(:,2) + alpha(i) + beta(i) .* P(:,i) + gamma(i) .* P(:,i).^2;
    end
	% constraints
    g = zeros(ps,0);
    h = sum(P,2)-PD-PL;
end
end
%% Program to for Admittance And Impedance Bus Formation....

function Y = ybus(linedata,f)  % Returns Y
linedata(:,4) = linedata(:,4).*f;
% linedata(:,3:4) = linedata(:,3:4).*10000/127^2;
% linedata(:,3:4) = linedata(:,3:4);


fb = linedata(:,1);             % From bus number...
tb = linedata(:,2);             % To bus number...
r = linedata(:,3);              % Resistance, R...
x = linedata(:,4);              % Reactance, X...
b = linedata(:,5);              % Ground Admittance, B/2...
a = linedata(:,6);              % Tap setting value..
z = r + 1j*x;                    % z matrix...
y = 1./z;                       % To get inverse of each element...
b = 1j*b;                        % Make B imaginary...

nb = max(max(fb),max(tb));      % No. of buses...
nl = length(fb);                % No. of branches...
Y = zeros(nb,nb);               % Initialise YBus...
 
 % Formation of the Off Diagonal Elements...
 for k = 1:nl
     Y(fb(k),tb(k)) = Y(fb(k),tb(k)) - y(k)/a(k);
     Y(tb(k),fb(k)) = Y(fb(k),tb(k));
 end
 
 % Formation of Diagonal Elements....
 for m = 1:nb
     for n = 1:nl
         if fb(n) == m
             Y(m,m) = Y(m,m) + y(n)/(a(n)^2) + b(n);
         elseif tb(n) == m
             Y(m,m) = Y(m,m) + y(n) + b(n);
         end
     end
 end
end